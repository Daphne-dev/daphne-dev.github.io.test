<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><meta name="naver-site-verification" content="456bc64502a0ef0523e1a94f89bc91d5db420691"><title>[JavaScript] 클로저(Closure) - Daphne&#039;s blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Daphne&#039;s blog"><meta name="msapplication-TileImage" content="/img/favicon_.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Daphne&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Daphne의 개발 블로그입니다"><meta property="og:type" content="blog"><meta property="og:title" content="Daphne&#039;s blog"><meta property="og:url" content="https://daphne-dev.github.io/"><meta property="og:site_name" content="Daphne&#039;s blog"><meta property="og:description" content="Daphne의 개발 블로그입니다"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://daphne-dev.github.io/img/og_image.png"><meta property="article:published_time" content="2021-01-13T14:18:43.000Z"><meta property="article:modified_time" content="2023-10-10T14:36:20.748Z"><meta property="article:author" content="Daphne"><meta property="article:tag" content="closure"><meta property="article:tag" content="클로저"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://daphne-dev.github.io/2021/01/13/JS_TS/JavaScript/javascript-004/"},"headline":"[JavaScript] 클로저(Closure)","image":[],"datePublished":"2021-01-13T14:18:43.000Z","dateModified":"2023-10-10T14:36:20.748Z","author":{"@type":"Person","name":"Daphne"},"publisher":{"@type":"Organization","name":"Daphne's blog","logo":{"@type":"ImageObject","url":"https://daphne-dev.github.io/img/logo_image.png"}},"description":"클로저(Closure)란 ? 어떤 함수에서 선언한 변수를 참조하는 내부함수를 외부로 전달할 경우, 함수의 실행 컨텍스트가 종료된 후에도 해당 변수가 사라지지 않는 현상이다.  렉시컬 환경(Lexical Environment)클로저에 대한 개념을 이해하기 위해서는 렉시컬 환경(Lexical Environment)에 대한 이해가 필요하다.자바스크립트에서는 실행"}</script><link rel="canonical" href="https://daphne-dev.github.io/2021/01/13/JS_TS/JavaScript/javascript-004/"><link rel="icon" href="/img/favicon_.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-173436998-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-173436998-1');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="Daphne's blog" type="application/rss+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo_image.png" alt="Daphne&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" target="_blank" rel="noopener" href="https://github.com/Daphne-dev">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Daphne-dev"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="카탈로그" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-01-13T14:18:43.000Z" title="2021. 1. 13. 오후 11:18:43">2021-01-13</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-10-10T14:36:20.748Z" title="2023. 10. 10. 오후 11:36:20">2023-10-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/JS-TS/">JS/TS</a><span> / </span><a class="link-muted" href="/categories/JS-TS/JavaScript/">JavaScript</a></span><span class="level-item">13분안에 읽기 (약 1898 단어)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>회 방문</span></div></div><h1 class="title is-3 is-size-4-mobile">[JavaScript] 클로저(Closure)</h1><div class="content"><h2 id="클로저-Closure-란"><a href="#클로저-Closure-란" class="headerlink" title="클로저(Closure)란 ?"></a>클로저(Closure)란 ?</h2><blockquote>
<p>어떤 함수에서 선언한 변수를 참조하는 내부함수를 외부로 전달할 경우, 함수의 실행 컨텍스트가 종료된 후에도 해당 변수가 사라지지 않는 현상이다.</p>
</blockquote>
<h2 id="렉시컬-환경-Lexical-Environment"><a href="#렉시컬-환경-Lexical-Environment" class="headerlink" title="렉시컬 환경(Lexical Environment)"></a>렉시컬 환경(Lexical Environment)</h2><p>클로저에 대한 개념을 이해하기 위해서는 렉시컬 환경(Lexical Environment)에 대한 이해가 필요하다.<br>자바스크립트에서는 <code>실행 중인 함수</code>, <code>코드 블록 &#123;...&#125;</code>, <code>스크립트 전체</code>는 렉시컬 환경이라 불리는 내부 숨김 연관 객체를 갖는다. <code>if 문</code>, <code>for 문</code> 등에서 사용되는 코드 블록도 이에 해당된다.</p>
<p>렉시컬 환경 객체는 두 부분으로 구성된다.</p>
<ol>
<li>환경 레코드(Environment Record) : 모든 지역 변수를 프로퍼티로 저장하고 있는 객체, <code>this</code>값과 같은 기타 정보도 여기에 저장된다.</li>
<li>외부 렉시컬 환경(Outer Lexical Environment)에 대한 참조 : 외부 코드와 연관됨</li>
</ol>
<p>코드를 통해 알아보자.</p>
<span id="more"></span>

<p><img src="/image/javascript_004_001.PNG" alt=""></p>
<p><code>변수 phrase</code>는 특수 내부 객체인 <code>환경 레코드</code>의 프로퍼티라고 할 수 있다.<br><code>변수를 가져오거나 변경</code>하는 것은 <code>환경 레코드의 프로퍼티를 가져오거나 변경</code>함을 의미한다.</p>
<p>위의 코드에는 렉시컬 환경이 하나만 존재하는데, 이렇게 스크립트 전체와 관련된 렉시컬 환경은 <code>전역 렉시컬 환경(Global Lexical Environment)</code>라고 한다.</p>
<p>전역 렉시컬 환경은 외부 참조를 갖지 않기 때문에 <code>null</code>을 가리키는 것을 알 수 있다.</p>
<p>이번엔 좀 더 긴 코드를 살펴보자.</p>
<p><img src="/image/javascript_004_002.PNG" alt=""></p>
<p>우측의 네모 상자들은 코드가 한 줄, 한 줄 실행될 때마다 전역 렉시컬 환경이 어떻게 변화하는지 보여준다.</p>
<ol>
<li>처음 스크립트가 시작되면 스크립트 내에서 선언한 변수 전체가 렉시컬 환경에 올라간다. 이때 변수의 상태는 <code>uninitialized</code>가 되는데 자바 스크립트 엔진은 해당 상태의 변수를 인지는 하지만 바로 밑의 <code>let</code>을 만나기 전까지는 이 변수를 사용할 수 없다.</li>
<li><code>let phrase</code> 선언은 했지만 값을 할당하지는 않았기 떄문에 <code>undefined</code> 상태이다.</li>
<li><code>Hello</code>가 할당된 상태</li>
<li><code>Bye</code>로 값이 변경된 상태</li>
</ol>
<p>여기서 짚고 넘어가야할 점이 하나 있는데 렉시컬 환경은 이론적으로 존재하는 공간이기 때문에 실제 자바스크립트 코드를 통해 직접 접근하거나 조작하는 행위는 불가능하다.</p>
<h2 id="함수-선언문에서의-렉시컬-환경"><a href="#함수-선언문에서의-렉시컬-환경" class="headerlink" title="함수 선언문에서의 렉시컬 환경"></a>함수 선언문에서의 렉시컬 환경</h2><p>함수 선언문으로 선언한 함수는 일반 변수와는 달리 바로 초기화된다.<br>이 말은 함수 선언문으로 선언한 함수는 렉시컬 환경이 만들어지는 즉시 사용할 수 있다는 말이다. 변수의 경우 <code>let</code>을 만나 선언이 될 때까지 사용할 수 없는 것과 달리 말이다.</p>
<p><img src="/image/javascript_004_003.PNG" alt=""></p>
<p>위 그림을 보면 선언되기 전에도 <code>say</code>가 함수임을 인지하고 있음을 확인할 수 있다.<br>단, 이런 방식은 함수 선언문의 경우만 적용이 된다.<br>아래와 같이 함수 표현식과 같은 경우 해당되지 않는다.</p>
<blockquote>
<p><code>let say = function(name)...</code></p>
</blockquote>
<h2 id="내부와-외부에서의-렉시컬-환경"><a href="#내부와-외부에서의-렉시컬-환경" class="headerlink" title="내부와 외부에서의 렉시컬 환경"></a>내부와 외부에서의 렉시컬 환경</h2><p>함수를 호출하여 실행하면 새로운 렉시컬 환경이 자동으로 만들어진다.<br>해당 렉시컬 환경에서는 함수 호출 시 넘겨받은 매개변수와 함수 안의 지역 변수가 저장된다.</p>
<p>아래의 코드를 살펴보자</p>
<p><img src="/image/javascript_004_004.PNG" alt=""></p>
<p><code>say(&quot;John&quot;)</code>을 호출하게 되면 두 개의 렉시컬 환경을 갖게 되는데, 내부 렉시컬 환경과 외부 렉시컬 환경이다.</p>
<p>내부 렉시컬 환경은 호출 중인 함수인 <code>say</code>를 위해 만들어져서 매개변수로 받은 name 값을 갖게 된다. 이 내부 렉시컬 환경은 외부 렉시컬 환경을 가리키는데 여기에서는 전역 렉시컬 환경을 가리키고 있다.</p>
<p>say 함수에서 <code>alert</code>가 실행될 때 name은 이미 내부 렉시컬 환경 내에 있기 때문에 넘어가게 되고 <code>phrase</code> 값을 찾을 수 없어서 내부 렉시컬이 가리키고 있는 외부 렉시컬 환경으로 접근해서 <code>phrase</code> 값을 찾게 된다.</p>
<p>이렇게 <code>내부 렉시컬 환경에서 찾을 수 없는 값을 외부 렉시컬 환경에 접근하여 찾는데, 이러한 과정은 검색 범위가 전역 렉시컬 환경으로 확장될 때까지 반복</code>된다.</p>
<p><img src="/image/javascript_004_005.PNG" alt=""></p>
<h2 id="반환-함수에서의-렉시컬-환경"><a href="#반환-함수에서의-렉시컬-환경" class="headerlink" title="반환 함수에서의 렉시컬 환경"></a>반환 함수에서의 렉시컬 환경</h2><p><img src="/image/javascript_004_006.PNG" alt=""></p>
<p><code>makeCounter()</code>을 호출하면 호출할 때마다 새로운 렉시컬 환경 객체가 만들어진다. 그리고 이 객체엔 <code>makeCounter</code>를 실행하는데 필요한 변수들이 저장된다. 위 그림을 보면 내부 렉시컬 환경과 전역 렉시컬 환경이 만들어지는 것읕 볼 수 있다.</p>
<p><img src="/image/javascript_004_007.PNG" alt=""></p>
<p>실행 흐름이 <code>makeCounter</code> 함수 내부의 함수까지 오게되면 내부 렉시컬 환경을 하나 더 만들게 되고 그 안에서 <code>count</code> 변수를 찾는다. 하지만 없기 때문에 참조 중인 <code>makeCounter</code> 함수의 렉시컬 환경으로 가서 찾는다.<br><code>count</code> 변수를 찾게 되고 0을 반환해주게 된다. 그 후 실행이 종료되면 아래 그림과 같이 <code>count</code> 값을 1 증가 시킨 상태가 된다.</p>
<p><img src="/image/javascript_004_008.PNG" alt=""></p>
<p><code>counter()</code>를 여러 번 호출하면 <code>count</code> 변수가 <code>2, 3</code>으로 증가하는 이유가 이 떄문이다.</p>
<h2 id="가비지-컬렉션"><a href="#가비지-컬렉션" class="headerlink" title="가비지 컬렉션"></a>가비지 컬렉션</h2><p>함수 호출이 끝나면 함수에 대응하는 렉시컬 환경이 메모리에서 제거되게 된다.<br>단, 해당 렉시컬 환경이 다른 렉시컬 환경으로부터 참조되고 있는 상태라면 여전히 메모리에 유지되게 된다.</p>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>클로저라는 개념은 말로 설명하기도 이해하기도 두루뭉술한 느낌의 개념이다. 하지만 클로저는 자바스크립트에서 중요한 개념으로 클로저의 특성을 이용해 코드를 작성한 것을 이해하고 자유자재로 다룰려면 꼭 알아두어야 한다.</p>
<p>앞서 말한대로 클로저란 어떤 함수에서 선언한 변수를 참조하는 내부함수를 외부로 전달할 경우, 함수의 실행 컨텍스트가 종료된 후에도 해당 변수가 사라지지 않는 현상이다. 그 이유는 내부 렉시컬 환경에서 찾을 수 없는 변수를 외부 렉시컬 환경에서 찾아서 참조하고 있기 때문이다.</p>
<p>내부함수를 외부로 전달하는 방법에는 함수를 <code>return</code>하는 경우뿐만 아니라 콜백으로 전달하는 경우도 포함된다.</p>
<p>클로저는 그 특성상 메모리를 계속 차지하는 개념이므로 사용이 끝난 클로저에 대해서 메모리를 관리에 주의해줄 필요가 있다.</p>
<p>이 글은 <a target="_blank" rel="noopener" href="https://ko.javascript.info/closure">모던 자바스크립트 - 클로저</a>를 참고해서 쓴 글입니다.</p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/closure/">closure</a><a class="link-muted mr-2" rel="tag" href="/tags/%ED%81%B4%EB%A1%9C%EC%A0%80/">클로저</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/01/18/Git/git-flow-github-flow-gitlab-flow/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Git flow, GitHub flow, GitLab flow</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/01/11/JS_TS/JavaScript/javascript-003/"><span class="level-item">[JavaScript] 함수 선언문과 함수 표현식</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">댓글</h3><script src="https://utteranc.es/client.js" repo="Daphne-dev/blog_comment" issue-term="pathname" label="some-issue-label" theme="github-light" crossorigin="anonymous" async></script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Daphne"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Daphne</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">205</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">31</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">151</p></a></div></div></nav></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">카탈로그</h3><ul class="menu-list"><li><a class="level is-mobile" href="#클로저-Closure-란"><span class="level-left"><span class="level-item">1</span><span class="level-item">클로저(Closure)란 ?</span></span></a></li><li><a class="level is-mobile" href="#렉시컬-환경-Lexical-Environment"><span class="level-left"><span class="level-item">2</span><span class="level-item">렉시컬 환경(Lexical Environment)</span></span></a></li><li><a class="level is-mobile" href="#함수-선언문에서의-렉시컬-환경"><span class="level-left"><span class="level-item">3</span><span class="level-item">함수 선언문에서의 렉시컬 환경</span></span></a></li><li><a class="level is-mobile" href="#내부와-외부에서의-렉시컬-환경"><span class="level-left"><span class="level-item">4</span><span class="level-item">내부와 외부에서의 렉시컬 환경</span></span></a></li><li><a class="level is-mobile" href="#반환-함수에서의-렉시컬-환경"><span class="level-left"><span class="level-item">5</span><span class="level-item">반환 함수에서의 렉시컬 환경</span></span></a></li><li><a class="level is-mobile" href="#가비지-컬렉션"><span class="level-left"><span class="level-item">6</span><span class="level-item">가비지 컬렉션</span></span></a></li><li><a class="level is-mobile" href="#결론"><span class="level-left"><span class="level-item">7</span><span class="level-item">결론</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo_image.png" alt="Daphne&#039;s blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Daphne</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv"><span id="busuanzi_value_site_uv">0</span>명의 사용자가 방문 함</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Daphne-dev"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"superSample":2,"position":"right","width":150,"height":300,"hOffset":0,"vOffset":-60},"mobile":{"show":true,"scale":0.4},"react":{"opacityDefault":0.7,"opacityOnHover":0.2}});</script></body></html>